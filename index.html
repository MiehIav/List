<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Advanced Link Hub</title>
    <style>
        /* --- General Styling & Theming --- */
        :root {
            --bg-color: #121212;
            --surface-color: #1e1e1e;
            --primary-color: #03dac6;
            --primary-variant-color: #018786;
            --secondary-color: #bb86fc;
            --text-color: #e1e1e1;
            --text-secondary-color: #a0a0a0;
            --border-color: #2c2c2c;
            --shadow-color: rgba(0, 0, 0, 0.4);
            --danger-color: #cf6679;
            --success-color: #4caf50;
            --warning-color: #ff9800;
            --info-color: #2196f3;
            --favorite-color: #ffd700;
        }

        body.light {
            --bg-color: #ffffff;
            --surface-color: #f5f5f5;
            --primary-color: #03dac6;
            --primary-variant-color: #018786;
            --secondary-color: #6200ee;
            --text-color: #212121;
            --text-secondary-color: #757575;
            --border-color: #e0e0e0;
            --shadow-color: rgba(0, 0, 0, 0.1);
            --danger-color: #b00020;
            --success-color: #388e3c;
            --warning-color: #f57c00;
            --info-color: #1976d2;
            --favorite-color: #ffcc00;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            transition: background-color 0.3s, color 0.3s;
        }

        /* --- Layout & Container --- */
        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 1rem;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2.5rem;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 1.5rem;
        }

        header h1 {
            color: var(--secondary-color);
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        header p {
            color: var(--text-secondary-color);
            font-size: 1.1rem;
        }

        #theme-toggle {
            background: none;
            border: 1px solid var(--border-color);
            color: var(--text-color);
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        #theme-toggle:hover {
            background-color: var(--surface-color);
        }

        /* --- Form & Input Styling --- */
        .form-container, .search-container, .controls {
            background-color: var(--surface-color);
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            box-shadow: 0 4px 12px var(--shadow-color);
            transition: background-color 0.3s, box-shadow 0.3s;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--text-secondary-color);
        }

        input[type="text"], input[type="url"], select, input[type="file"] {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            background-color: var(--bg-color);
            color: var(--text-color);
            font-size: 1rem;
            transition: border-color 0.3s, box-shadow 0.3s;
        }

        input[type="text"]:focus, input[type="url"]:focus, select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(3, 218, 198, 0.3);
        }

        button {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: background-color 0.3s, transform 0.2s;
        }

        button.primary {
            background-color: var(--primary-color);
            color: #000;
        }

        button.primary:hover {
            background-color: var(--primary-variant-color);
            transform: translateY(-2px);
        }

        button.secondary {
            background-color: transparent;
            border: 1px solid var(--border-color);
            color: var(--text-color);
        }

        button.secondary:hover {
            background-color: var(--border-color);
        }

        button.danger {
            background-color: var(--danger-color);
            color: #fff;
        }

        button.danger:hover {
            background-color: #b00020;
        }

        /* --- Link Card Styling --- */
        #link-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .link-card {
            background-color: var(--surface-color);
            border-radius: 8px;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            box-shadow: 0 4px 12px var(--shadow-color);
            transition: transform 0.3s, box-shadow 0.3s;
            position: relative;
        }

        .link-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px var(--shadow-color);
        }

        .link-card.favorite::before {
            content: '‚òÖ';
            position: absolute;
            top: 10px;
            right: 10px;
            color: var(--favorite-color);
            font-size: 1.5rem;
        }

        .link-card h3 {
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
            word-break: break-all;
        }

        .link-card a {
            color: var(--primary-color);
            text-decoration: none;
            word-break: break-all;
            transition: color 0.3s;
        }

        .link-card a:hover {
            color: var(--secondary-color);
            text-decoration: underline;
        }

        .link-card .date {
            font-size: 0.85rem;
            color: var(--text-secondary-color);
            margin-bottom: 0.5rem;
        }

        .link-card .tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .tag {
            background-color: var(--border-color);
            padding: 0.3rem 0.6rem;
            border-radius: 15px;
            font-size: 0.85rem;
            color: var(--text-color);
        }

        .link-card .actions {
            margin-top: auto;
            display: flex;
            gap: 0.5rem;
            justify-content: flex-end;
        }

        .actions button {
            background: none;
            border: none;
            color: var(--text-secondary-color);
            font-size: 1.2rem;
            cursor: pointer;
            transition: color 0.3s;
            padding: 0.4rem;
        }

        .actions button:hover {
            color: var(--text-color);
        }

        .actions .edit-btn:hover {
            color: var(--info-color);
        }

        .actions .delete-btn:hover {
            color: var(--danger-color);
        }

        .actions .fav-btn.favorited {
            color: var(--favorite-color);
        }

        .empty-state {
            text-align: center;
            padding: 3rem;
            color: var(--text-secondary-color);
            background: var(--surface-color);
            border-radius: 8px;
            grid-column: 1 / -1;
        }

        /* --- Modal Styling --- */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
            z-index: 1000;
        }

        .modal-overlay.visible {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background-color: var(--surface-color);
            padding: 2rem;
            border-radius: 8px;
            width: 90%;
            max-width: 600px;
            transform: scale(0.9);
            transition: transform 0.3s, background-color 0.3s;
        }

        .modal-overlay.visible .modal-content {
            transform: scale(1);
        }

        .modal-content h2 {
            margin-bottom: 1.5rem;
            color: var(--secondary-color);
        }

        .modal-actions {
            margin-top: 1.5rem;
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }

        /* --- Toast Notification --- */
        #toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--surface-color);
            color: var(--text-color);
            padding: 1rem 2rem;
            border-radius: 5px;
            box-shadow: 0 4px 12px var(--shadow-color);
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 1001;
        }

        #toast.visible {
            opacity: 1;
        }

        /* --- Animations --- */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .link-card {
            animation: fadeIn 0.3s ease-out;
        }

        /* --- Responsive Design --- */
        @media (max-width: 600px) {
            .container {
                padding: 0.5rem;
            }

            header {
                flex-direction: column;
                text-align: center;
            }

            header h1 {
                font-size: 2rem;
            }

            #link-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <div>
                <h1>My Advanced Link Hub</h1>
                <p>Your professional, feature-rich link management dashboard. Powered by localStorage.</p>
            </div>
            <button id="theme-toggle">üåô Toggle Theme</button>
        </header>

        <main>
            <div class="form-container">
                <form id="add-link-form">
                    <div class="form-group">
                        <label for="link-title">Link Title</label>
                        <input type="text" id="link-title" placeholder="e.g., Awesome Design Tools" required>
                    </div>
                    <div class="form-group">
                        <label for="link-url">Link URL</label>
                        <input type="url" id="link-url" placeholder="https://www.example.com" required>
                    </div>
                    <div class="form-group">
                        <label for="link-tags">Tags (comma-separated)</label>
                        <input type="text" id="link-tags" placeholder="e.g., design, tools, ui">
                    </div>
                    <button type="submit" class="primary">+ Add Link</button>
                </form>
            </div>

            <div class="search-container">
                <div class="form-group">
                    <label for="search-input">üîç Search Links (title, URL, tags)</label>
                    <input type="text" id="search-input" placeholder="Search by title, URL, or tags...">
                </div>
                <div class="form-group">
                    <label for="filter-tags">Filter by Tags (multi-select)</label>
                    <select id="filter-tags" multiple>
                        <!-- Options dynamically populated -->
                    </select>
                </div>
            </div>

            <div class="controls">
                <div class="form-group" style="display: inline-block; width: 48%; margin-right: 4%;">
                    <label for="sort-by">Sort By</label>
                    <select id="sort-by">
                        <option value="date">Date Added</option>
                        <option value="title">Title</option>
                        <option value="url">URL</option>
                    </select>
                </div>
                <div class="form-group" style="display: inline-block; width: 48%;">
                    <label for="order">Order</label>
                    <select id="order">
                        <option value="desc">Descending</option>
                        <option value="asc">Ascending</option>
                    </select>
                </div>
                <button id="export-btn" class="secondary">üì§ Export Links</button>
                <button id="import-btn" class="secondary">üì• Import Links</button>
                <button id="clear-all" class="danger">üóë Clear All</button>
                <input type="file" id="import-file" accept=".json" style="display: none;">
            </div>

            <div id="link-container">
                <!-- Links will be dynamically inserted here -->
            </div>
        </main>
    </div>

    <!-- Edit Modal -->
    <div id="edit-modal" class="modal-overlay">
        <div class="modal-content">
            <h2>‚úé Edit Link</h2>
            <form id="edit-link-form">
                <input type="hidden" id="edit-link-id">
                <div class="form-group">
                    <label for="edit-link-title">Link Title</label>
                    <input type="text" id="edit-link-title" required>
                </div>
                <div class="form-group">
                    <label for="edit-link-url">Link URL</label>
                    <input type="url" id="edit-link-url" required>
                </div>
                <div class="form-group">
                    <label for="edit-link-tags">Tags (comma-separated)</label>
                    <input type="text" id="edit-link-tags">
                </div>
                <div class="modal-actions">
                    <button type="button" id="cancel-edit-btn" class="secondary">Cancel</button>
                    <button type="submit" class="primary">Save Changes</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast"></div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- DOM Element References ---
            const addLinkForm = document.getElementById('add-link-form');
            const linkTitleInput = document.getElementById('link-title');
            const linkUrlInput = document.getElementById('link-url');
            const linkTagsInput = document.getElementById('link-tags');
            const linkContainer = document.getElementById('link-container');
            const searchInput = document.getElementById('search-input');
            const filterTagsSelect = document.getElementById('filter-tags');
            const sortBySelect = document.getElementById('sort-by');
            const orderSelect = document.getElementById('order');
            const exportBtn = document.getElementById('export-btn');
            const importBtn = document.getElementById('import-btn');
            const importFile = document.getElementById('import-file');
            const clearAllBtn = document.getElementById('clear-all');
            const themeToggle = document.getElementById('theme-toggle');
            const toast = document.getElementById('toast');

            const editModal = document.getElementById('edit-modal');
            const editLinkForm = document.getElementById('edit-link-form');
            const editLinkId = document.getElementById('edit-link-id');
            const editLinkTitle = document.getElementById('edit-link-title');
            const editLinkUrl = document.getElementById('edit-link-url');
            const editLinkTags = document.getElementById('edit-link-tags');
            const cancelEditBtn = document.getElementById('cancel-edit-btn');

            // --- Data Management (using localStorage) ---
            const STORAGE_KEY = 'myAdvancedLinkHubLinks';
            const THEME_KEY = 'myAdvancedLinkHubTheme';

            const getLinks = () => {
                const links = localStorage.getItem(STORAGE_KEY);
                return links ? JSON.parse(links) : [];
            };

            const saveLinks = (links) => {
                localStorage.setItem(STORAGE_KEY, JSON.stringify(links));
            };

            // --- Theme Management ---
            const loadTheme = () => {
                const theme = localStorage.getItem(THEME_KEY) || 'dark';
                document.body.classList.toggle('light', theme === 'light');
                themeToggle.textContent = theme === 'light' ? 'üåô Dark Mode' : '‚òÄÔ∏è Light Mode';
            };

            const toggleTheme = () => {
                document.body.classList.toggle('light');
                const isLight = document.body.classList.contains('light');
                localStorage.setItem(THEME_KEY, isLight ? 'light' : 'dark');
                themeToggle.textContent = isLight ? 'üåô Dark Mode' : '‚òÄÔ∏è Light Mode';
            };

            themeToggle.addEventListener('click', toggleTheme);
            loadTheme();

            // --- Utility Functions ---
            const escapeHTML = (str) => {
                const p = document.createElement('p');
                p.textContent = str;
                return p.innerHTML;
            };

            const parseTags = (tagsStr) => {
                return tagsStr.split(',').map(t => t.trim()).filter(t => t);
            };

            const getAllUniqueTags = () => {
                const links = getLinks();
                const allTags = links.flatMap(link => link.tags);
                return [...new Set(allTags)].sort();
            };

            const populateTagOptions = () => {
                filterTagsSelect.innerHTML = '';
                const tags = getAllUniqueTags();
                tags.forEach(tag => {
                    const option = document.createElement('option');
                    option.value = tag;
                    option.textContent = tag;
                    filterTagsSelect.appendChild(option);
                });
            };

            const showToast = (message, duration = 3000) => {
                toast.textContent = message;
                toast.classList.add('visible');
                setTimeout(() => {
                    toast.classList.remove('visible');
                }, duration);
            };

            // --- Sorting Function ---
            const sortLinks = (links, sortBy, order) => {
                const sorted = [...links];
                const multiplier = order === 'asc' ? 1 : -1;
                sorted.sort((a, b) => {
                    if (sortBy === 'date') {
                        return multiplier * (new Date(a.date) - new Date(b.date));
                    } else if (sortBy === 'title') {
                        return multiplier * a.title.localeCompare(b.title);
                    } else if (sortBy === 'url') {
                        return multiplier * a.url.localeCompare(b.url);
                    }
                    return 0;
                });
                return sorted;
            };

            // --- Core Rendering Function ---
            const renderLinks = () => {
                linkContainer.innerHTML = '';
                const links = getLinks();
                const searchTerm = searchInput.value.toLowerCase();
                const selectedTags = Array.from(filterTagsSelect.selectedOptions).map(opt => opt.value);
                const sortBy = sortBySelect.value;
                const order = orderSelect.value;

                let filteredLinks = links.filter(link => {
                    const matchesSearch = link.title.toLowerCase().includes(searchTerm) ||
                                          link.url.toLowerCase().includes(searchTerm) ||
                                          link.tags.some(tag => tag.toLowerCase().includes(searchTerm));
                    const matchesTags = selectedTags.length === 0 || link.tags.some(tag => selectedTags.includes(tag));
                    return matchesSearch && matchesTags;
                });

                filteredLinks = sortLinks(filteredLinks, sortBy, order);

                if (filteredLinks.length === 0) {
                    linkContainer.innerHTML = `<div class="empty-state"><h3>No links found.</h3><p>Add a new link or adjust your filters!</p></div>`;
                    return;
                }

                filteredLinks.forEach(link => {
                    const linkCard = document.createElement('div');
                    linkCard.className = 'link-card';
                    if (link.favorite) linkCard.classList.add('favorite');
                    linkCard.dataset.id = link.id;

                    linkCard.innerHTML = `
                        <div>
                            <h3>${escapeHTML(link.title)}</h3>
                            <a href="${escapeHTML(link.url)}" target="_blank" rel="noopener noreferrer">${escapeHTML(link.url)}</a>
                            <div class="tags">${link.tags.map(tag => `<span class="tag">${escapeHTML(tag)}</span>`).join('')}</div>
                            <p class="date">Added: ${new Date(link.date).toLocaleDateString()}</p>
                        </div>
                        <div class="actions">
                            <button class="fav-btn" title="Toggle Favorite">${link.favorite ? '‚òÖ' : '‚òÜ'}</button>
                            <button class="edit-btn" title="Edit">‚úé</button>
                            <button class="delete-btn" title="Delete">üóë</button>
                        </div>
                    `;
                    linkContainer.appendChild(linkCard);
                });
            };

            // --- Event Handlers ---
            addLinkForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const title = linkTitleInput.value.trim();
                const url = linkUrlInput.value.trim();
                const tagsStr = linkTagsInput.value.trim();

                if (title && url) {
                    const newLink = {
                        id: Date.now().toString(),
                        title,
                        url,
                        tags: parseTags(tagsStr),
                        date: new Date().toISOString(),
                        favorite: false
                    };
                    const links = getLinks();
                    links.unshift(newLink);
                    saveLinks(links);
                    populateTagOptions();
                    renderLinks();
                    addLinkForm.reset();
                    showToast('Link added successfully!');
                }
            });

            linkContainer.addEventListener('click', (e) => {
                const linkCard = e.target.closest('.link-card');
                if (!linkCard) return;
                
                const linkId = linkCard.dataset.id;
                let links = getLinks();
                const linkIndex = links.findIndex(link => link.id === linkId);

                if (linkIndex === -1) return;

                // Handle Favorite
                if (e.target.classList.contains('fav-btn')) {
                    links[linkIndex].favorite = !links[linkIndex].favorite;
                    saveLinks(links);
                    renderLinks();
                    showToast(links[linkIndex].favorite ? 'Added to favorites!' : 'Removed from favorites');
                }

                // Handle Delete
                if (e.target.classList.contains('delete-btn')) {
                    if (confirm('Are you sure you want to delete this link?')) {
                        links.splice(linkIndex, 1);
                        saveLinks(links);
                        populateTagOptions();
                        renderLinks();
                        showToast('Link deleted.');
                    }
                }

                // Handle Edit
                if (e.target.classList.contains('edit-btn')) {
                    const linkToEdit = links[linkIndex];
                    editLinkId.value = linkToEdit.id;
                    editLinkTitle.value = linkToEdit.title;
                    editLinkUrl.value = linkToEdit.url;
                    editLinkTags.value = linkToEdit.tags.join(', ');
                    editModal.classList.add('visible');
                }
            });

            editLinkForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const id = editLinkId.value;
                const newTitle = editLinkTitle.value.trim();
                const newUrl = editLinkUrl.value.trim();
                const newTagsStr = editLinkTags.value.trim();

                if (id && newTitle && newUrl) {
                    let links = getLinks();
                    const linkIndex = links.findIndex(link => link.id === id);
                    if (linkIndex > -1) {
                        links[linkIndex] = { 
                            ...links[linkIndex],
                            title: newTitle, 
                            url: newUrl,
                            tags: parseTags(newTagsStr)
                        };
                        saveLinks(links);
                        populateTagOptions();
                        renderLinks();
                        closeEditModal();
                        showToast('Link updated successfully!');
                    }
                }
            });

            const closeEditModal = () => {
                editModal.classList.remove('visible');
            };

            cancelEditBtn.addEventListener('click', closeEditModal);
            editModal.addEventListener('click', (e) => {
                if (e.target === editModal) {
                    closeEditModal();
                }
            });

            // Search and Filter Listeners
            searchInput.addEventListener('input', renderLinks);
            filterTagsSelect.addEventListener('change', renderLinks);
            sortBySelect.addEventListener('change', renderLinks);
            orderSelect.addEventListener('change', renderLinks);

            // Export
            exportBtn.addEventListener('click', () => {
                const links = getLinks();
                const blob = new Blob([JSON.stringify(links, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'links.json';
                a.click();
                URL.revokeObjectURL(url);
                showToast('Links exported!');
            });

            // Import
            importBtn.addEventListener('click', () => importFile.click());
            importFile.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (ev) => {
                        try {
                            const imported = JSON.parse(ev.target.result);
                            if (confirm('Replace existing links with imported ones?')) {
                                saveLinks(imported);
                                populateTagOptions();
                                renderLinks();
                                showToast('Links imported successfully!');
                            }
                        } catch (err) {
                            showToast('Invalid JSON file.', 5000);
                        }
                    };
                    reader.readAsText(file);
                }
                importFile.value = ''; // Reset for next use
            });

            // Clear All
            clearAllBtn.addEventListener('click', () => {
                if (confirm('Are you sure you want to clear all links? This cannot be undone.')) {
                    saveLinks([]);
                    populateTagOptions();
                    renderLinks();
                    showToast('All links cleared.');
                }
            });

            // --- Keyboard Shortcuts ---
            document.addEventListener('keydown', (e) => {
                if (e.ctrlKey || e.metaKey) {
                    if (e.key === 's') {
                        e.preventDefault();
                        searchInput.focus();
                    } else if (e.key === 'a') {
                        e.preventDefault();
                        linkTitleInput.focus();
                    }
                }
            });

            // --- Initial Load ---
            populateTagOptions();
            renderLinks();
        });
    </script>

</body>
</html>
